"use strict";(self["webpackChunkmockups"]=self["webpackChunkmockups"]||[]).push([[80],{2694:(e,l,a)=>{a.r(l),a.d(l,{default:()=>ke});var t=a(3673),o=a(7786),u=a(2323),n=a(1959),i=a(6665),c=a(4417),d=a(5826),s=a(1289),r=a(4826),m=a(4913),p=a(4842),v=a(8825),f=a(8251),b=a(3787),w=a(765),y=a(1214),V=a(8333),h=a(1185),Z=a(3940),_=a(7831),U=a(2946);const g=(0,U.r)(),W=(0,_.Q_)("factura",{state:()=>({facturasByID:{}}),getters:{},actions:{validateFactura(e){const l=[];return""==e.clienteID&&l.push("Debe seleccionar un cliente"),""==e.tipoPago&&l.push("Debe seleccionar un tipo de pago"),l.length>0||e.detalles.forEach((e=>{const a=g.get(e.codigo);e.cantidad>a.cantidad&&l.push(`No hay suficiente ${a.descripcion}, quedan ${a.cantidad}${a.unidadPreferida}`)})),l},registerFactura(e){this.facturasByID[e.id]=e,e.detalles.forEach((e=>{g.affect(e.codigo,(l=>(l.cantidad-=e.cantidad,l.costeTotal-=l.costeUnitario*e.cantidad,l)))}))},findByID(e){return[this.facturasByID[e]]},findByCliente(e){return Object.values(this.facturasByID).filter((l=>l.clienteID.startsWith(e)))},findByFecha(e){return Object.values(this.facturasByID).filter((l=>l.fecha==e))}},persist:!0}),I=e=>((0,t.dD)("data-v-4675b5dd"),e=e(),(0,t.Cn)(),e),D={class:"row items-center"},C=I((()=>(0,t._)("span",{class:"titulo-pagina"},"Factura de venta",-1))),k={class:"comprobante"},N=I((()=>(0,t._)("br",null,null,-1))),q=I((()=>(0,t._)("br",null,null,-1))),S=I((()=>(0,t._)("br",null,null,-1))),M={class:"col-auto row items-end justify-end relative-position"},B={class:"col-auto q-pa-sm item-bordered shadow-2 total"},Q=I((()=>(0,t._)("br",null,null,-1))),F={class:"row items-center justify-end"},P={class:"row items-center justify-end"},R=I((()=>(0,t._)("br",null,null,-1))),j=I((()=>(0,t._)("br",null,null,-1))),H={class:"shadow-2 total bg-white full-width text-center"},E=(0,t.aZ)({emits:["facturaCreada"],setup(e,{emit:l}){const a=(0,v.Z)(),o=(0,n.iH)(0),_=(0,n.iH)(null),U=W(),g=(0,n.iH)(new V.v({id:(0,h.Z)()})),I=(0,n.iH)([{label:"",value:""}]),E=(0,n.iH)(""),T=[{field:"item",label:"Item",type:w.N.STRING},{field:"codigo",label:"Codigo",type:w.N.NUMBER},{field:"precio",label:"Precio",responsive:!0,type:w.N.NUMBER,formatter:b.M,prefix:"$"},{field:"descuento",label:"Descuento",type:w.N.NUMBER},{field:"impuesto",label:"Impuesto",type:w.N.NUMBER,formatter:e=>`${e}%`},{field:"cantidad",label:"Cantidad",responsive:!0,type:w.N.NUMBER,formatter:b.M},{field:"total",label:"Total",type:w.N.NUMBER,formatter:b.M,prefix:"$"}],x=(0,n.iH)(new y.f({}));function $(){a.dialog({component:m.Z}).onOk((e=>{x.value=e,I.value=Object.entries(f.M.instance().getUnits(x.value.dimension)).map((e=>({label:e[1].symbol,value:e[0]})));const l=f.M.instance().dimensions[x.value.dimension].baseUnit;E.value=f.M.instance().getUnits(x.value.dimension)[l].symbol,setTimeout((()=>{_.value.focus(),_.value.select()}),100)}))}function Y(){a.dialog({component:Z.Z}).onOk((e=>{e.clienteID?g.value.clienteID=e.clienteID:g.value.clienteID=e.proveedorID,g.value.clienteNombre=e.nombre}))}const z=(0,n.iH)(0),O=(0,n.iH)(0),G=(0,n.iH)("%");function A(){let e="0%",l=x.value.precioVenta*z.value;0!==O.value&&("%"===G.value?(l-=l*(O.value/100),e=`${O.value}%`):(l-=O.value,e=`$${O.value}`)),g.value.detalles.push({codigo:x.value.codigo,item:x.value.descripcion,impuesto:x.value.impuesto,precio:x.value.precioVenta,descuento:e,cantidad:z.value,total:l}),x.value=new y.f({}),z.value=0,O.value=0}const L=(0,t.Fl)((()=>{let e=0;return g.value.detalles.forEach((l=>{e+=l.total})),e})),J=(0,n.iH)(!0);function K(e){J.value=e.isIntersecting}const X=(0,n.iH)("");function ee(){g.value=new V.v({}),x.value=new y.f({}),z.value=0,O.value=0,X.value=""}function le(){g.value.total=L.value,l("facturaCreada",g.value);const e=U.validateFactura(g.value);e.length>0?e.forEach((e=>{a.notify(e)})):(U.registerFactura(g.value),g.value=new V.v({id:(0,h.Z)()}))}return(e,l)=>{const m=(0,t.up)("q-space"),v=(0,t.up)("q-select"),f=(0,t.up)("q-btn"),w=(0,t.up)("q-resize-observer"),y=(0,t.up)("q-date"),V=(0,t.up)("q-popup-proxy"),h=(0,t.up)("q-icon"),Z=(0,t.up)("q-card-section"),U=(0,t.up)("q-card"),W=(0,t.up)("q-page-sticky"),X=(0,t.Q2)("intersection"),ae=(0,t.Q2)("close-popup");return(0,t.wg)(),(0,t.iD)(t.HY,null,[(0,t.Wm)(U,{flat:""},{default:(0,t.w5)((()=>[(0,t.Wm)(Z,{style:(0,u.j5)({"padding-bottom":o.value+"px"})},{default:(0,t.w5)((()=>[(0,t._)("div",D,[C,(0,t.Wm)(m),(0,t._)("span",k,"ID Factura: "+(0,u.zw)(g.value.id),1)]),N,(0,t.Wm)(c.Z,null,{action:(0,t.w5)((()=>[(0,t.Wm)(f,{class:"advance-btn",label:"Agregar item",onClick:A})])),default:(0,t.w5)((()=>[(0,t.Wm)(r.Z,{"help-key":""},{default:(0,t.w5)((()=>[(0,t.Wm)((0,n.SU)(p.Z),{modelValue:x.value.descripcion,"onUpdate:modelValue":l[0]||(l[0]=e=>x.value.descripcion=e),label:"Item",readonly:"",onClick:$},null,8,["modelValue"])])),_:1}),(0,t.Wm)(r.Z,{"help-key":"factura:cantidad"},{default:(0,t.w5)((()=>[(0,t.Wm)((0,n.SU)(p.Z),{ref_key:"cantidadHTML",ref:_,modelValue:z.value,"onUpdate:modelValue":l[2]||(l[2]=e=>z.value=e),modelModifiers:{number:!0},label:"Cantidad",placeholder:"Ingrese cantidad",type:"number"},{append:(0,t.w5)((()=>[(0,t.Wm)(v,{modelValue:E.value,"onUpdate:modelValue":l[1]||(l[1]=e=>E.value=e),options:I.value,"emit-value":"","map-options":""},null,8,["modelValue","options"])])),_:1},8,["modelValue"])])),_:1}),(0,t.Wm)((0,n.SU)(p.Z),{modelValue:O.value,"onUpdate:modelValue":l[4]||(l[4]=e=>O.value=e),label:"Descuento",placeholder:"Ingrese descuento"},{append:(0,t.w5)((()=>[(0,t.Wm)(v,{modelValue:G.value,"onUpdate:modelValue":l[3]||(l[3]=e=>G.value=e),options:["%","$"]},null,8,["modelValue"])])),_:1},8,["modelValue"])])),_:1}),q,(0,t.Wm)(s.Z,{actions:[{icon:"delete",onClick:(e,l)=>{g.value.detalles.splice(l,1)},class:"revert-btn"}],data:g.value.detalles,schema:T,title:"Items"},null,8,["actions","data"]),S,(0,t.wy)(((0,t.wg)(),(0,t.iD)("div",M,[(0,n.SU)(a).platform.is.mobile?((0,t.wg)(),(0,t.j4)(w,{key:0,onResize:l[5]||(l[5]=({height:e})=>{o.value=e})})):(0,t.kq)("",!0),(0,t._)("span",B,[(0,t._)("b",null,"Total factura: $"+(0,u.zw)((0,n.SU)(b.M)((0,n.SU)(L))),1)])])),[[X,K]]),Q,(0,t.Wm)(c.Z,null,{default:(0,t.w5)((()=>[(0,t.Wm)((0,n.SU)(p.Z),{modelValue:g.value.fecha,"onUpdate:modelValue":l[7]||(l[7]=e=>g.value.fecha=e),label:"Fecha"},{append:(0,t.w5)((()=>[(0,t.Wm)(h,{class:"cursor-pointer",name:"event"},{default:(0,t.w5)((()=>[(0,t.Wm)(V,{ref:"qDateProxy",cover:"","transition-hide":"scale","transition-show":"scale"},{default:(0,t.w5)((()=>[(0,t.Wm)(y,{modelValue:g.value.fecha,"onUpdate:modelValue":l[6]||(l[6]=e=>g.value.fecha=e),mask:"DD/MM/YYYY"},{default:(0,t.w5)((()=>[(0,t._)("div",F,[(0,t.wy)((0,t.Wm)(f,{color:"primary",flat:"",label:"Close"},null,512),[[ae]])])])),_:1},8,["modelValue"])])),_:1},512)])),_:1})])),_:1},8,["modelValue"]),(0,t.Wm)((0,n.SU)(p.Z),{modelValue:g.value.fechaVencimiento,"onUpdate:modelValue":l[9]||(l[9]=e=>g.value.fechaVencimiento=e),label:"Fecha Vencimiento"},{append:(0,t.w5)((()=>[(0,t.Wm)(h,{class:"cursor-pointer",name:"event"},{default:(0,t.w5)((()=>[(0,t.Wm)(V,{ref:"qDateProxy",cover:"","transition-hide":"scale","transition-show":"scale"},{default:(0,t.w5)((()=>[(0,t.Wm)(y,{modelValue:g.value.fechaVencimiento,"onUpdate:modelValue":l[8]||(l[8]=e=>g.value.fechaVencimiento=e),mask:"DD/MM/YYYY"},{default:(0,t.w5)((()=>[(0,t._)("div",P,[(0,t.wy)((0,t.Wm)(f,{color:"primary",flat:"",label:"Close"},null,512),[[ae]])])])),_:1},8,["modelValue"])])),_:1},512)])),_:1})])),_:1},8,["modelValue"])])),_:1}),R,(0,t.Wm)(c.Z,null,{default:(0,t.w5)((()=>[(0,t.Wm)((0,n.SU)(p.Z),{label:"Nit/CC",modelValue:g.value.clienteID,"onUpdate:modelValue":l[10]||(l[10]=e=>g.value.clienteID=e),readonly:"",onClick:Y},null,8,["modelValue"]),(0,t.Wm)((0,n.SU)(p.Z),{label:"Nombre",modelValue:g.value.clienteNombre,"onUpdate:modelValue":l[11]||(l[11]=e=>g.value.clienteNombre=e),readonly:""},null,8,["modelValue"]),(0,t.Wm)(v,{label:"Tipo Pago",modelValue:g.value.tipoPago,"onUpdate:modelValue":l[12]||(l[12]=e=>g.value.tipoPago=e),options:["Efectivo","Credito"]},null,8,["modelValue"])])),_:1}),j,(0,t.Wm)(d.Z,{btns:[{label:"Cancelar",fn:()=>{(0,n.SU)(a).dialog({component:i.Z,componentProps:{mensaje:"Â¿Seguro que quieres cancelar?"}}).onOk((l=>{e.x,(0,n.SU)(a).notify("Factura cancelada"),ee()})).onCancel((()=>{(0,n.SU)(a).notify("Cancelado")}))},class:"revert-btn shadow-10"},{label:"Guardar",fn:le}]},null,8,["btns"])])),_:1},8,["style"])])),_:1}),J.value?(0,t.kq)("",!0):((0,t.wg)(),(0,t.j4)(W,{key:0,expand:"",position:"bottom"},{default:(0,t.w5)((()=>[(0,t._)("span",H,[(0,t._)("b",null,"Total factura: $"+(0,u.zw)((0,n.SU)(b.M)((0,n.SU)(L))),1)])])),_:1}))],64)}}});var T=a(4260),x=a(151),$=a(5589),Y=a(2025),z=a(3017),O=a(8240),G=a(5151),A=a(4554),L=a(3944),J=a(6915),K=a(1007),X=a(5094),ee=a(677),le=a(7518),ae=a.n(le);const te=(0,T.Z)(E,[["__scopeId","data-v-4675b5dd"]]),oe=te;ae()(E,"components",{QCard:x.Z,QCardSection:$.Z,QSpace:Y.Z,QInput:p.Z,QSelect:z.Z,QBtn:O.Z,QResizeObserver:G.Z,QIcon:A.Z,QPopupProxy:L.Z,QDate:J.Z,QPageSticky:K.Z}),ae()(E,"directives",{Intersection:X.Z,ClosePopup:ee.Z});const ue=e=>((0,t.dD)("data-v-ee2a0ce6"),e=e(),(0,t.Cn)(),e),ne=ue((()=>(0,t._)("span",{class:"titulo-pagina"},"Factura de venta",-1))),ie={class:"comprobante"},ce=ue((()=>(0,t._)("br",null,null,-1))),de=ue((()=>(0,t._)("br",null,null,-1))),se={class:"col-auto row items-end justify-end relative-position"},re={class:"col-auto q-pa-sm item-bordered shadow-2 total"},me=ue((()=>(0,t._)("br",null,null,-1))),pe=ue((()=>(0,t._)("br",null,null,-1))),ve=(0,t.aZ)({props:{factura:null},setup(e){const l=(0,v.Z)(),a=(0,n.iH)(0),o=[{field:"item",label:"Item",type:w.N.STRING},{field:"codigo",label:"Codigo",type:w.N.NUMBER},{field:"precio",label:"Precio",responsive:!0,type:w.N.NUMBER,formatter:b.M,prefix:"$"},{field:"descuento",label:"Descuento",type:w.N.NUMBER},{field:"impuesto",label:"Impuesto",type:w.N.NUMBER,formatter:e=>`${e}%`},{field:"cantidad",label:"Cantidad",responsive:!0,type:w.N.NUMBER,formatter:b.M},{field:"total",label:"Total",type:w.N.NUMBER,formatter:b.M,prefix:"$"}];return(i,d)=>{const r=(0,t.up)("q-space"),m=(0,t.up)("q-resize-observer"),v=(0,t.up)("q-card-section"),f=(0,t.up)("q-card");return(0,t.wg)(),(0,t.j4)(f,{flat:""},{default:(0,t.w5)((()=>[(0,t.Wm)(v,null,{default:(0,t.w5)((()=>[(0,t._)("div",{style:(0,u.j5)({"padding-top":a.value+"px"}),class:"row items-center"},[ne,(0,t.Wm)(r),(0,t._)("span",ie,"ID Factura: "+(0,u.zw)(e.factura.id),1)],4),ce,(0,t.Wm)(s.Z,{data:e.factura.detalles,schema:o,title:"Items"},null,8,["data"]),de,(0,t._)("div",se,[(0,n.SU)(l).platform.is.mobile?((0,t.wg)(),(0,t.j4)(m,{key:0,onResize:d[0]||(d[0]=({height:e})=>{a.value=e})})):(0,t.kq)("",!0),(0,t._)("span",re,[(0,t._)("b",null,"Total factura: $"+(0,u.zw)((0,n.SU)(b.M)(e.factura.total)),1)])]),me,(0,t.Wm)(c.Z,null,{default:(0,t.w5)((()=>[(0,t.Wm)((0,n.SU)(p.Z),{modelValue:e.factura.fecha,"onUpdate:modelValue":d[1]||(d[1]=l=>e.factura.fecha=l),label:"Fecha",readonly:""},null,8,["modelValue"]),(0,t.Wm)((0,n.SU)(p.Z),{modelValue:e.factura.fechaVencimiento,"onUpdate:modelValue":d[2]||(d[2]=l=>e.factura.fechaVencimiento=l),label:"Fecha Vencimiento",readonly:""},null,8,["modelValue"])])),_:1}),pe,(0,t.Wm)(c.Z,null,{default:(0,t.w5)((()=>[(0,t.Wm)((0,n.SU)(p.Z),{label:"Nit/CC",modelValue:e.factura.clienteID,"onUpdate:modelValue":d[3]||(d[3]=l=>e.factura.clienteID=l),readonly:""},null,8,["modelValue"]),(0,t.Wm)((0,n.SU)(p.Z),{label:"Nombre",modelValue:e.factura.clienteNombre,"onUpdate:modelValue":d[4]||(d[4]=l=>e.factura.clienteNombre=l),readonly:""},null,8,["modelValue"]),(0,t.Wm)((0,n.SU)(p.Z),{label:"Tipo Pago",modelValue:e.factura.tipoPago,"onUpdate:modelValue":d[5]||(d[5]=l=>e.factura.tipoPago=l),readonly:""},null,8,["modelValue"])])),_:1})])),_:1})])),_:1})}}}),fe=(0,T.Z)(ve,[["__scopeId","data-v-ee2a0ce6"]]),be=fe;ae()(ve,"components",{QCard:x.Z,QCardSection:$.Z,QSpace:Y.Z,QResizeObserver:G.Z,QInput:p.Z});const we=e=>((0,t.dD)("data-v-f863aca6"),e=e(),(0,t.Cn)(),e),ye={key:1},Ve={key:3},he={class:"row items-center justify-end"},Ze={key:5},_e=we((()=>(0,t._)("br",null,null,-1))),Ue=(0,t.aZ)({setup(e){const l=(0,n.iH)("ID"),a=[{label:"Buscar por ID",value:"ID"},{label:"Buscar por Cliente",value:"Cliente"},{label:"Buscar por Fecha",value:"Fecha"}],o=W(),u=(0,n.iH)(""),i=(0,n.iH)([]),d=(0,n.iH)(null);function r(){f.dialog({component:Z.Z}).onOk((e=>{e.clienteID?u.value=e.clienteID:u.value=e.proveedorID}))}function m(){switch(l.value){case"ID":i.value=o.findByID(u.value);break;case"Cliente":i.value=o.findByCliente(u.value);break;case"Fecha":i.value=o.findByFecha(u.value);break}console.log(i.value)}const f=(0,v.Z)(),y=[{field:"id",label:"ID",responsive:!0,type:w.N.STRING},{field:"fecha",label:"Fecha",responsive:!0,type:w.N.STRING},{field:"clienteID",label:"Nit/CC",responsive:!0,type:w.N.STRING},{field:"tipoPago",label:"Tipo de pago",responsive:!0,type:w.N.STRING},{field:"total",label:"Total",responsive:!0,type:w.N.NUMBER,formatter:b.M,prefix:"$"}];return(e,o)=>{const v=(0,t.up)("q-select"),f=(0,t.up)("q-btn"),b=(0,t.up)("q-date"),w=(0,t.up)("q-popup-proxy"),V=(0,t.up)("q-icon"),h=(0,t.up)("q-card-section"),Z=(0,t.up)("q-card"),_=(0,t.Q2)("close-popup");return(0,t.wg)(),(0,t.j4)(Z,{flat:""},{default:(0,t.w5)((()=>[(0,t.Wm)(h,null,{default:(0,t.w5)((()=>["ID"===l.value?((0,t.wg)(),(0,t.j4)(c.Z,{key:0},{default:(0,t.w5)((()=>[(0,t.Wm)(v,{label:"Modo",modelValue:l.value,"onUpdate:modelValue":o[0]||(o[0]=e=>l.value=e),options:a,"emit-value":"","map-options":""},null,8,["modelValue"]),(0,t.Wm)((0,n.SU)(p.Z),{label:"ID",modelValue:u.value,"onUpdate:modelValue":o[1]||(o[1]=e=>u.value=e)},null,8,["modelValue"]),(0,t.Wm)(f,{label:"Buscar",class:"full-width",onClick:m})])),_:1})):(0,t.kq)("",!0),"ID"===l.value?((0,t.wg)(),(0,t.iD)("br",ye)):(0,t.kq)("",!0),"Cliente"===l.value?((0,t.wg)(),(0,t.j4)(c.Z,{key:2},{default:(0,t.w5)((()=>[(0,t.Wm)(v,{label:"Modo",modelValue:l.value,"onUpdate:modelValue":o[2]||(o[2]=e=>l.value=e),options:a,"emit-value":"","map-options":""},null,8,["modelValue"]),(0,t.Wm)((0,n.SU)(p.Z),{label:"Nit/CC",modelValue:u.value,"onUpdate:modelValue":o[3]||(o[3]=e=>u.value=e),readonly:"",onClick:r},null,8,["modelValue"]),(0,t.Wm)(f,{label:"Buscar",class:"full-width",onClick:m})])),_:1})):(0,t.kq)("",!0),"Cliente"===l.value?((0,t.wg)(),(0,t.iD)("br",Ve)):(0,t.kq)("",!0),"Fecha"===l.value?((0,t.wg)(),(0,t.j4)(c.Z,{key:4},{default:(0,t.w5)((()=>[(0,t.Wm)(v,{label:"Modo",modelValue:l.value,"onUpdate:modelValue":o[4]||(o[4]=e=>l.value=e),options:a,"emit-value":"","map-options":""},null,8,["modelValue"]),(0,t.Wm)((0,n.SU)(p.Z),{modelValue:u.value,"onUpdate:modelValue":o[6]||(o[6]=e=>u.value=e),label:"Fecha"},{append:(0,t.w5)((()=>[(0,t.Wm)(V,{class:"cursor-pointer",name:"event"},{default:(0,t.w5)((()=>[(0,t.Wm)(w,{ref:"qDateProxy",cover:"","transition-hide":"scale","transition-show":"scale"},{default:(0,t.w5)((()=>[(0,t.Wm)(b,{modelValue:u.value,"onUpdate:modelValue":o[5]||(o[5]=e=>u.value=e),mask:"DD/MM/YYYY"},{default:(0,t.w5)((()=>[(0,t._)("div",he,[(0,t.wy)((0,t.Wm)(f,{color:"primary",flat:"",label:"Close"},null,512),[[_]])])])),_:1},8,["modelValue"])])),_:1},512)])),_:1})])),_:1},8,["modelValue"]),(0,t.Wm)(f,{label:"Buscar",class:"full-width",onClick:m})])),_:1})):(0,t.kq)("",!0),"Fecha"===l.value?((0,t.wg)(),(0,t.iD)("br",Ze)):(0,t.kq)("",!0),(0,t.Wm)(s.Z,{schema:y,data:i.value,actions:[{icon:"check_circle",onClick:(e,l)=>{d.value=e},class:"advance-btn"}]},null,8,["data","actions"]),_e,d.value?((0,t.wg)(),(0,t.j4)(be,{key:6,factura:d.value},null,8,["factura"])):(0,t.kq)("",!0)])),_:1})])),_:1})}}}),ge=(0,T.Z)(Ue,[["__scopeId","data-v-f863aca6"]]),We=ge;ae()(Ue,"components",{QCard:x.Z,QCardSection:$.Z,QSelect:z.Z,QInput:p.Z,QBtn:O.Z,QIcon:A.Z,QPopupProxy:L.Z,QDate:J.Z}),ae()(Ue,"directives",{ClosePopup:ee.Z});const Ie=(0,t.aZ)({setup(e){const l=(0,n.iH)(new V.v({}));function a(e){l.value=e}return(e,u)=>{const n=(0,t.up)("q-page");return(0,t.wg)(),(0,t.j4)(n,null,{default:(0,t.w5)((()=>[(0,t.Wm)(o.Z,{tabs:["Crear","Buscar"]},{Crear:(0,t.w5)((()=>[(0,t.Wm)(oe,{onFacturaCreada:a})])),Buscar:(0,t.w5)((()=>[(0,t.Wm)(We,{factura:l.value},null,8,["factura"])])),_:1})])),_:1})}}});var De=a(4379);const Ce=Ie,ke=Ce;ae()(Ie,"components",{QPage:De.Z})}}]);